무신사는 주문번호에 상태를 업데이트함.

주문상태    클레임상태

출고요청    클레임무효
구매확정    환불요청
결제오류    환불완료
배송완료    교환요청
주문취소    주문취소
입금예정
배송시작


구매확정  => 클레임 무효
배송완료  => 환불요청
배송완료  => 환불완료

출고요청 에서 환불완료건이 제일 많음.

배송완료 상태로 종료되는 건도 있음.

주문상세



출고요청: 입금확인된 주문으로 상품 및 재고를 확인합니다. 수령자 정보 변경, 옵션 변경, 환불처리가 가능합니다.
출고처리중: 상품 및 재고가 확인된 주문을 준비하여 수령자 정보를 택배사에 등록하여 송장번호를 받습니다. 수령자 정보 변경, 옵션 변경, 주문취소가 불가능합니다. 업체는 환불 및 품절 클레임 작성으로 주문취소가 가능합니다.
출고완료: 주문을 포장하여 택배사로 인계 합니다. 출고완료 전환 시 송장정보가 수령자에게 문자 전송이 됩니다.
배송시작: 택배사에 집하되어 고객에게 배송 중 입니다.
배송완료: 고객이 상품을 수령하였습니다.
구매확정: 수령한 상품을 구매하기로 결정하였습니다. 후기 등록과 적립금이 지급됩니다.
입금예정: 미입금 가상계좌 주문서 입니다.
주문취소: 미입금으로 주문이 취소 되었습니다. (미입금으로 인한 자동 주문취소 or 고객에 의한 취소)(주문상태 만들어줘야할수있음)
결제오류: 결제 진행 중 카드 한도 초과, 카드 사용 오류 등으로 인해 결제되지 않은 주문입니다


입금예정(주문완료)
출고요청(주문완료)


주문
입금예정
입금확인
주문취소
출고요청
출고완료
배송시작
배송완료
구매확정
교환/반품/환불
환불완료



샘플
https://bizest.musinsa.com/po/order/ord01/detail?ORD_NO=201911052331539930&ORD_OPT_NO=43003436&LAYOUT_TYPE=popup#
환불완료	정상	정상	goal	G19FMM1SW01_B		리스펙트 스웨트셔츠 (블랙)	L	1(54)	89,000	0	0	0
환불완료	정상	정상	goal	G19FMB1PT31B		카고 조거팬츠 (블랙)	L	1(24)	89,000	0	0
합계	적립금 : 0원, 배송료 : 2,500원, 추가배송료 : 0원	178,000	0	0	0
클레임환불완료
주문 처리일시
주문일자	2019.11.06 09:58:06
입금일자	2019.11.06 09:58:07
최종 처리일자	2019.11.06 09:58:07
주문완료	2019.11.06 09:58:07
상품준비중
상품출고완료




https://bizest.musinsa.com/po/order/ord01/receipt?ORD_NO=201911060954283848&LAYOUT_TYPE=popup
적립금사용액	10,119	주문총액	178,000
쿠폰사용액	9,790	결제수수료	0
할인금액	3,560	배송비


2019/11/18

3PL이지만 직배송 해야하는 채널도 있는지 ? 출고상태 RELEASE 추가


현재 RAW_EVENT  KEY에 STATE 를 추가 해야할 필요성이 있는지?

우리는 타임 스탬프 이지만  채널은 DATE 로 주면서
주문 과 주문취고사 동시에 발생 한다면
주문 INSERT 후 주문취소로 업데이트 발생

무신사처럼 마지막 상태만 관리하는 데이터는

주문 데이터를 만들어 줄때 주문일자를 강제로 만들어야 하는데
명확히 주문일자가 없는 데이터는 환불 및 주문취소 일자로 넣어지면 업데이트가 발생함.
채널에서 일자 데이터를 정확히 준다는 보장없음.



주문  => 출고요청 => 출고 =>               배송완료 => 교환 반품 환불
  주문취소| 배송중 =>미배송(?일이상 배송중)  |


주문취합 =>만재물류 => 배송완료

물류센터 출고 후에는 주문취소가아닌 반품 환불로 가야함.



매출을 기준으로 보면

(+)     :   (-)
주문        주문취소, 주문취소요청
출고요청     환불요청
출고        환불
배송완료


기존 상태
ORDER,
EXCHANGE,
RETURN,
OTHER

현재 상태
ORDER("ORDER"),        //주문
RELEASE("RELEASE"),    //출고
CANCEL("CANCEL"),      //주문취소
COMPLETE("COMPLETE"),  //배송완료      ssg는 ORDER로 수집했음
EXCHANGE("EXCHANGE"),  //교환
RETURN("RETURN"),      //환불
CLAIM("CLAIM"),        //클레임
OTHER("OTHER"),
NONE("NONE");         //처리안함
